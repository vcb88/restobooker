# Базовое описание архитектуры проекта: Telegram бот для бронирования столиков

## 1. Обзор архитектуры
Система будет состоять из нескольких ключевых компонентов: Telegram-бот, Large Language Model (LLM) для обработки естественного языка, база данных для хранения информации о бронированиях и ресторанах, а также опциональный модуль интеграции с внешними системами управления рестораном (RMS).

## 2. Основные компоненты

### 2.1. Telegram-бот
*   **Тип:** Обычный пользовательский аккаунт Telegram (не Bot API аккаунт), что позволит имитировать человеческое общение и обходить некоторые ограничения Bot API.
*   **Функционал:**
    *   Прием сообщений от пользователей.
    *   Отправка сообщений пользователям (подтверждения, вопросы, информация).
    *   Обработка базовых команд (например, /start, /help).
    *   Передача пользовательских запросов в LLM.
    *   Отображение информации из базы данных пользователям.

### 2.2. Large Language Model (LLM)
*   **Цель:** Интерпретация запросов пользователей, написанных на естественном языке.
*   **Функционал:**
    *   **Распознавание намерений (Intent Recognition):** Определение цели сообщения пользователя (бронирование, изменение бронирования, отмена, запрос информации).
    *   **Извлечение сущностей (Entity Extraction):** Выделение ключевых параметров из запроса (дата, время, количество персон, имя, особые пожелания, название ресторана).
    *   **Генерация ответов:** Формирование осмысленных и контекстуально релевантных ответов пользователю.
    *   **Диалоговое управление:** Поддержание контекста диалога и запрос недостающей информации.
*   **Выбор LLM:** Будет рассмотрено использование Gemini, GPT или другой подходящей модели, доступной через API.

### 2.3. Серверная часть (Backend Application)
*   **Технологии:** Python (FastAPI/Django) или Node.js (Express) как основной фреймворк.
*   **Функционал:**
    *   Взаимодействие с Telegram-ботом (получение и отправка сообщений).
    *   Интеграция с LLM API.
    *   Управление бизнес-логикой бронирования (проверка доступности, создание/изменение/отмена бронирований).
    *   Взаимодействие с базой данных.
    *   Обработка логики аутентификации/авторизации для персонала ресторана (если будет веб-интерфейс).
    *   **Опционально:** Предоставление REST API для внешних систем или внутреннего веб-интерфейса.

### 2.4. База данных
*   **Тип:** PostgreSQL, MySQL или SQLite (для MVP).
*   **Структура:** Хранение информации о:
    *   Ресторанах (название, адрес, контакты, режим работы, описание столов/зон).
    *   Столиках/Зонах (номер/название, вместимость, статус).
    *   Бронированиях (клиент, дата, время, количество персон, столик, статус, особые пожелания).
    *   Пользователях Telegram.
    *   Персонале ресторана.

### 2.5. Модуль интеграции с RMS (Опционально)
*   **Цель:** Синхронизация данных о бронированиях и доступности столиков с существующими системами управления рестораном (iiko, R-Keeper и т.д.).
*   **Функционал:**
    *   API-интеграция с RMS (если доступно).
    *   Обработка данных в реальном времени или по расписанию.
    *   Маппинг данных между собственной БД и RMS.

## 3. Потоки данных (Пример: новое бронирование)
1.  **Клиент** отправляет сообщение в Telegram-бот.
2.  **Telegram-бот** пересылает сообщение на **Серверную часть**.
3.  **Серверная часть** передает текст сообщения в **LLM** для интерпретации.
4.  **LLM** возвращает серверной части извлеченные сущности (дата, время, количество персон и т.д.) и подтвержденное намерение.
5.  **Серверная часть** проверяет доступность столиков в **Базе данных** (и/или через **Модуль интеграции с RMS**).
6.  Если столик найден: **Серверная часть** создает запись о бронировании в **Базе данных**.
7.  **Серверная часть** формирует ответ и отправляет его через **Telegram-бота** **Клиенту**.
8.  **Персонал ресторана** получает уведомление о новом бронировании (через Telegram-бот или отдельный интерфейс).

## 4. Развитие архитектуры
Начальная архитектура будет стремиться к максимальной простоте для быстрого создания MVP. По мере развития проекта будут добавляться дополнительные модули (например, для отчетности, управления меню, CRM-функционал).
